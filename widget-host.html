<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widget Host Application</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://rsms.me/inter/inter.css');
        html { font-family: 'Inter', sans-serif; }
        body { background-color: #f3f4f6; } /* bg-gray-100 */
    </style>
</head>
<body class="p-4 sm:p-8">
    <header class="mb-8 max-w-5xl mx-auto">
        <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">My Main Application</h1>
        <p class="text-gray-600 mt-2">This page demonstrates embedding the Electrical Floor Plan tool as a widget.</p>
    </header>

    <main class="max-w-5xl mx-auto">
        <h2 class="text-2xl font-semibold text-gray-700 mb-4">Floor Plan Widget</h2>
        <div class="bg-white p-2 sm:p-4 rounded-xl shadow-lg">
            <p class="mb-4 text-gray-700 text-sm sm:text-base">The tool below is running in an isolated iframe. It connects to the Supabase backend for data storage, but its UI is completely encapsulated.</p>
            <div class="w-full h-[85vh] border-2 border-gray-300 rounded-lg overflow-hidden bg-gray-900">
                <iframe 
                    id="floorplan-widget"
                    src="/index.html" 
                    class="w-full h-full" 
                    frameborder="0"
                    title="Electrical Floor Plan Markup Tool">
                </iframe>
            </div>
        </div>
    </main>

    <footer class="mt-8 text-center text-gray-500 max-w-5xl mx-auto">
        <p>This is footer content outside the widget.</p>
    </footer>

    <script>
        const widgetFrame = document.getElementById('floorplan-widget');

        // --- IMPORTANT ---
        // Replace these with your actual Supabase project URL and anon key.
        // It's recommended to load these from environment variables in a real application.
        const supabaseConfigForWidget = {
            url: "YOUR_SUPABASE_URL",
            anonKey: "YOUR_SUPABASE_ANON_KEY"
        };

        widgetFrame.onload = () => {
            console.log("Widget iframe loaded. Sending Supabase config...");
            const message = {
                type: 'supabase-config',
                config: supabaseConfigForWidget
            };
            // The targetOrigin should be the widget's URL in a production environment
            // for security. Using '*' is acceptable for local development.
            widgetFrame.contentWindow.postMessage(message, '*');
        };
    </script>
</body>
</html>